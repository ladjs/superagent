var root="undefined"==typeof window?this||self:window;function noop(){}function isHost(obj){var str={}.toString.call(obj);switch(str){case"[object File]":case"[object Blob]":case"[object FormData]":return true;default:return false}}request.a=function(){if(root.XMLHttpRequest&&(!root.location||"file:"!=root.location.protocol||!root.ActiveXObject)){return new XMLHttpRequest}else{try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(e){}try{return new ActiveXObject("Msxml2.XMLHTTP.6.0")}catch(e){}try{return new ActiveXObject("Msxml2.XMLHTTP.3.0")}catch(e){}try{return new ActiveXObject("Msxml2.XMLHTTP")}catch(e){}}return false};var trim="".trim?function(s){return s.trim()}:function(s){return s.replace(/(^\s*|\s*$)/g,"")};function isObject(obj){return obj===Object(obj)}function serialize(obj){if(!isObject(obj))return obj;var pairs=[];for(var key in obj){if(null!=obj[key]){pairs.push(encodeURIComponent(key)+"="+encodeURIComponent(obj[key]))}}return pairs.join("&")}request.b=serialize;function parseString(str){var obj={};var pairs=str.split("&");var parts;var pair;for(var i=0,len=pairs.length;i<len;++i){pair=pairs[i];parts=pair.split("=");obj[decodeURIComponent(parts[0])]=decodeURIComponent(parts[1])}return obj}request.c=parseString;request.d={e:"text/html",f:"application/json",g:"application/xml",h:"application/x-www-form-urlencoded",i:"application/x-www-form-urlencoded",j:"application/x-www-form-urlencoded"};request.k={l:serialize,m:JSON.stringify};request.parse={l:parseString,m:JSON.parse};function parseHeader(str){var lines=str.split(/\r?\n/);var fields={};var index;var line;var field;var val;lines.pop();for(var i=0,len=lines.length;i<len;++i){line=lines[i];index=line.indexOf(":");field=line.slice(0,index).toLowerCase();val=trim(line.slice(index+1));fields[field]=val}return fields}function type(str){return str.split(/ *; */).shift()}function params(str){return reduce(str.split(/ *; */),function(obj,str){var parts=str.split(/ *= */),key=parts.shift(),val=parts.shift();if(key&&val)obj[key]=val;return obj},{})}function Response(req,options){options=options||{};this.n=req;this.o=this.n.o;this.p=this.n.q!="HEAD"&&(this.o.responseType===""||this.o.responseType==="text")||typeof this.o.responseType==="undefined"?this.o.responseText:null;this.r=this.n.o.r;this.s(this.o.t);this.u=this.v=parseHeader(this.o.getAllResponseHeaders());this.u["w"]=this.o.getResponseHeader("content-type");this.x(this.u);this.y=this.n.q!="HEAD"?this.z(this.p?this.p:this.o.A):null}Response.prototype.B=function(field){return this.u[field.toLowerCase()]};Response.prototype.x=function(header){var ct=this.u["w"]||"";this.C=type(ct);var obj=params(ct);for(var key in obj)this[key]=obj[key]};Response.prototype.z=function(str){var parse=request.parse[this.C];return parse&&str&&(str.length||str instanceof Object)?parse(str):null};Response.prototype.s=function(status){if(status===1223){status=204}var type=status/100|0;this.t=status;this.D=type;this.F=1==type;this.G=2==type;this.H=4==type;this.I=5==type;this.J=4==type||5==type?this.K():false;this.L=202==status;this.M=204==status;this.N=400==status;this.O=401==status;this.P=406==status;this.Q=404==status;this.R=403==status};Response.prototype.K=function(){var req=this.n;var method=req.q;var url=req.S;var msg="cannot "+method+" "+url+" ("+this.t+")";var err=new Error(msg);err.t=this.t;err.q=method;err.S=url;return err};request.T=Response;function Request(method,url){var self=this;Emitter.call(this);this.U=this.U||[];this.q=method;this.S=url;this.u={};this.V={};this.on("end",function(){var err=null;var res=null;try{res=new Response(self)}catch(e){err=new Error("Parser is unable to parse the response");err.parse=true;err.W=e;return self.X(err)}self.emit("response",res);if(err){return self.X(err,res)}if(res.t>=200&&res.t<300){return self.X(err,res)}var new_err=new Error(res.r||"Unsuccessful HTTP response");new_err.W=err;new_err.A=res;new_err.t=res.t;self.X(err||new_err,res)})}Emitter(Request.prototype);Request.prototype.Y=function(fn){fn(this);return this};Request.prototype.Z=function(ms){this.$=ms;return this};Request.prototype._=function(){this.$=0;clearTimeout(this.aa);return this};Request.prototype.ba=function(){if(this.ca)return;this.ca=true;this.o.ba();this._();this.emit("abort");return this};Request.prototype.da=function(field,val){if(isObject(field)){for(var key in field){this.da(key,field[key])}return this}this.V[field.toLowerCase()]=val;this.u[field]=val;return this};Request.prototype.ea=function(field){delete this.V[field.toLowerCase()];delete this.u[field];return this};Request.prototype.fa=function(field){return this.V[field.toLowerCase()]};Request.prototype.C=function(type){this.da("Content-Type",request.d[type]||type);return this};Request.prototype.ga=function(type){this.da("Accept",request.d[type]||type);return this};Request.prototype.ha=function(user,pass){var str=btoa(user+":"+pass);this.da("Authorization","Basic "+str);return this};Request.prototype.ia=function(val){if("string"!=typeof val)val=serialize(val);if(val)this.U.push(val);return this};Request.prototype.ja=function(name,val){if(!this.ka)this.ka=new root.FormData;this.ka.append(name,val);return this};Request.prototype.la=function(field,file,filename){if(!this.ka)this.ka=new root.FormData;this.ka.append(field,file,filename);return this};Request.prototype.ma=function(data){var obj=isObject(data);var type=this.fa("Content-Type");if(obj&&isObject(this.na)){for(var key in data){this.na[key]=data[key]}}else if("string"==typeof data){if(!type)this.C("form");type=this.fa("Content-Type");if("application/x-www-form-urlencoded"==type){this.na=this.na?this.na+"&"+data:data}else{this.na=(this.na||"")+data}}else{this.na=data}if(!obj||isHost(data))return this;if(!type)this.C("json");return this};Request.prototype.X=function(err,res){var fn=this.oa;this._();fn(err,res)};Request.prototype.pa=function(){var err=new Error("Origin is not allowed by Access-Control-Allow-Origin");err.qa=true;this.X(err)};Request.prototype.ra=function(){var timeout=this.$;var err=new Error("timeout of "+timeout+"ms exceeded");err.Z=timeout;this.X(err)};Request.prototype.sa=function(){this.ta=true;return this};Request.prototype.ua=function(fn){var self=this;var xhr=this.o=request.a();var query=this.U.join("&");var timeout=this.$;var data=this.ka||this.na;this.oa=fn||noop;xhr.va=function(){if(4!=xhr.readyState)return;var status;try{status=xhr.t}catch(e){status=0}if(0==status){if(self.wa)return self.ra();if(self.ca)return;return self.pa()}self.emit("end")};var handleProgress=function(e){if(e.total>0){e.xa=e.loaded/e.total*100}self.emit("progress",e)};if(this.hasListeners("progress")){xhr.ya=handleProgress}try{if(xhr.upload&&this.hasListeners("progress")){xhr.upload.ya=handleProgress}}catch(e){}if(timeout&&!this.aa){this.aa=setTimeout(function(){self.wa=true;self.ba()},timeout)}if(query){query=request.b(query);this.S+=~this.S.indexOf("?")?"&"+query:"?"+query}xhr.open(this.q,this.S,true);if(this.ta)xhr.sa=true;if("GET"!=this.q&&"HEAD"!=this.q&&"string"!=typeof data&&!isHost(data)){var serialize=request.k[this.fa("Content-Type")];if(serialize)data=serialize(data)}for(var field in this.u){if(null==this.u[field])continue;xhr.setRequestHeader(field,this.u[field])}this.emit("request",this);xhr.ma(data);return this};request.za=Request;function request(method,url){if("function"==typeof url){return new Request("GET",method).ua(url)}if(1==arguments.length){return new Request("GET",method)}return new Request(method,url)}request.B=function(url,data,fn){var req=request("GET",url);if("function"==typeof data)fn=data,data=null;if(data)req.ia(data);if(fn)req.ua(fn);return req};request.Aa=function(url,data,fn){var req=request("HEAD",url);if("function"==typeof data)fn=data,data=null;if(data)req.ma(data);if(fn)req.ua(fn);return req};request.Ba=function(url,fn){var req=request("DELETE",url);if(fn)req.ua(fn);return req};request.Ca=function(url,data,fn){var req=request("PATCH",url);if("function"==typeof data)fn=data,data=null;if(data)req.ma(data);if(fn)req.ua(fn);return req};request.Da=function(url,data,fn){var req=request("POST",url);if("function"==typeof data)fn=data,data=null;if(data)req.ma(data);if(fn)req.ua(fn);return req};request.Ea=function(url,data,fn){var req=request("PUT",url);if("function"==typeof data)fn=data,data=null;if(data)req.ma(data);if(fn)req.ua(fn);return req};